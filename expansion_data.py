import pandas as pd

def get_net_expansion(initial_temp, max_temp):
    # Create the data structure
    exp_factor_data = {
        40: [0.0100, 0.0124, 0.0150, 0.0179, 0.0209, 0.0242, 0.0276, 0.0313, 0.0351, 0.0391, 0.0434, 0.0476, 0.0522],
        50: [0.0099, 0.0123, 0.0149, 0.0178, 0.0208, 0.0241, 0.0275, 0.0312, 0.0350, 0.0390, 0.0433, 0.0475, 0.0521],
        60: [0.0095, 0.0118, 0.0145, 0.0173, 0.0204, 0.0236, 0.0271, 0.0307, 0.0346, 0.0386, 0.0428, 0.0471, 0.0517],
        70: [0.0086, 0.0109, 0.0135, 0.0164, 0.0194, 0.0227, 0.0261, 0.0298, 0.0336, 0.0376, 0.0419, 0.0461, 0.0507],
        80: [0.0074, 0.0098, 0.0124, 0.0153, 0.0181, 0.0216, 0.0250, 0.0287, 0.0325, 0.0365, 0.0408, 0.0450, 0.0496],
        90: [0.0060, 0.0083, 0.0110, 0.0133, 0.0165, 0.0201, 0.0236, 0.0272, 0.0311, 0.0351, 0.0393, 0.0436, 0.0482],
        100: [0.0043, 0.0066, 0.0093, 0.0121, 0.0148, 0.0184, 0.0219, 0.0255, 0.0294, 0.0334, 0.0376, 0.0419, 0.0465],
        110: [0.0023, 0.0047, 0.0073, 0.0101, 0.0129, 0.0165, 0.0199, 0.0236, 0.0274, 0.0314, 0.0356, 0.0399, 0.0445],
        120: [None, 0.0023, 0.0052, 0.0078, 0.0109, 0.0141, 0.0176, 0.0212, 0.0251, 0.0291, 0.0333, 0.0376, 0.0422],
    }
    exp_factor_max_temp_index = [120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240]
    df = pd.DataFrame(exp_factor_data, index=exp_factor_max_temp_index)
    try:
        value = df.loc[max_temp, initial_temp]
        return value
    except KeyError:
        return "Temperature out of range"

def get_acceptance_factor(min_pressure, max_pressure):
    # Create the data structure
    acceptance_factor = {
        5: [0.527, 0.560, 0.604, 0.640, 0.670, 0.696, 0.717, 0.736, 0.753, 0.767, 0.780, 0.792, 0.812, 0.828, 0.842],
        10: [0.408, 0.447, 0.503, 0.548, 0.586, 0.618, 0.646, 0.669, 0.690, 0.708, 0.725, 0.739, 0.764, 0.785, 0.802],
        12: [0.360, 0.403, 0.463, 0.512, 0.553, 0.587, 0.617, 0.643, 0.665, 0.685, 0.702, 0.718, 0.745, 0.767, 0.786],
        15: [0.288, 0.336, 0.403, 0.457, 0.503, 0.541, 0.574, 0.602, 0.627, 0.649, 0.669, 0.686, 0.716, 0.741, 0.762],
        20: [0.168, 0.224, 0.302, 0.366, 0.419, 0.464, 0.502, 0.536, 0.565, 0.590, 0.613, 0.634, 0.669, 0.698, 0.723],
        30: [None, None, 0.101, 0.183, 0.251, 0.309, 0.359, 0.402, 0.439, 0.472, 0.502, 0.528, 0.573, 0.610, 0.642],
        40: [None, None, None, None, 0.084, 0.155, 0.215, 0.268, 0.314, 0.354, 0.390, 0.422, 0.478, 0.523, 0.561],
        50: [None, None, None, None, None, None, 0.072, 0.134, 0.188, 0.236, 0.279, 0.317, 0.382, 0.436, 0.481],
        60: [None, None, None, None, None, None, None, None, 0.062, 0.118, 0.167, 0.211, 0.287, 0.347, 0.401],
        70: [None, None, None, None, None, None, None, None, None, None, 0.056, 0.106, 0.191, 0.261, 0.321],
        80: [None, None, None, None, None, None, None, None, None, None, None, None, 0.096, 0.174, 0.241],
    }

    # Corrected index (maximum operating pressures)
    max_pressure_index = [27, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 90, 100, 110]


    # Convert the dictionary to a DataFrame
    df = pd.DataFrame(acceptance_factor, index=max_pressure_index)

    try:
        value = df.loc[max_pressure, min_pressure]  # Use .loc to retrieve the value
        if pd.isna(value):  # Check for missing value
            return "Value not available in table"
        return value
    except KeyError:
        return "Pressure out of range"
